<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>reveal.js</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/black.css" id="theme">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">

    <style>
        pre.red {
            color: red;
        }

        pre.green {
            color: lawngreen;
        }

        .sidenode {
            font-size: 2.5rem;
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: white;
            background: rgba(0, 0, 0, 0.4);
            padding: 5px 10px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <!-- Intro -->
        <section>
            <h1>Greenfield TDD</h1>
            <h4>Testdriven Development f√ºr Anf√§nger</h4>
            <hr>
            <p style="font-size:1.1rem">
                Torsten Zielke<br>
                torsten.zielke@protonmail.com<br>
                Software Developer @Check24
            </p>
        </section>

        <section>
            <h1>Ablauf</h1>
            <ul>
                <li>‚ùî Ein paar Fragen</li>
                <li>üèÜ Motivation / Vorteile</li>
                <li>üî≠ Fakten/Wissenschaft</li>
                <li>üìÉ 3 Regeln des TDD</li>
                <li>üè≠ Praxis</li>
            </ul>
        </section>

        <section>
            <h2>Worum es nicht geht</h2>
            <div class="fragment">
                <hr>
                <h5>Allgemeines Unittesting</h5>
                <h5>CI/CD</h5>
            </div>
            <aside class="notes">
                Stattdessen TDD -> Was ist das? Und warum √ºberhaupt?
            </aside>
        </section>

        <!-- Interaktion/Fragen -->
        <section>
            <section>
                <h1>Fragestunde</h1>
            </section>

            <section>
                <h2>Erfahrungen mit automatisierten Tests generell? (z.B. PHPUnit)</h2>
                <hr>
                <p style="font-size:42px">https://www.strawpoll.me/21029462</p>
                <aside class="notes">
                    In Chat kopieren ;) - https://www.strawpoll.me/21029462
                </aside>
            </section>

            <section>
                <h2>Erfahrungen mit TDD?</h2>
                <hr>
                <p style="font-size:42px">https://www.strawpoll.me/21029466</p>
            </section>

            <section>
                <h2>Macht es Spa√ü, Tests zu schreiben?¬π</h2>
                <p style="font-size:42px">https://www.strawpoll.me/21029503</p>

                <div class="fragment">
                    <iframe src="https://giphy.com/embed/3orif5HoRWOMYZBfDG" width="480" height="277" frameBorder="0"
                            class="giphy-embed" allowFullScreen></iframe>
                    <p style="font-size:small"><a
                            href="https://giphy.com/gifs/season-16-the-simpsons-16x5-3orif5HoRWOMYZBfDG">via GIPHY</a>
                    </p>
                </div>
            </section>

            <section>
                <h4>Warum ist das so</h4>
                <h4 class="fragment">?</h4>
                <ul>
                    <li class="fragment">Wenn wir Tests <b>nachher</b> schreiben, wissen wir ja bereits, dass es l√§uft!
                    </li>
                    <li class="fragment">Das macht keinen Spa√ü (‚ï•Ôπè‚ï•)</li>
                    <li class="fragment">Wir haben durch manuelles Testen ja bereits gepr√ºft -> Es l√§uft, aber ...</li>
                    <li class="fragment">... wie h√§ufig testen wir manuell? Ist das nicht sehr repetitiv?</li>
                    <li class="fragment">Kann man repetitive Dinge nicht irgendwie auslagern ;) ...</li>
                </ul>
                <aside class="notes">In die Runde Fragen ;)</aside>
            </section>

            <section>
                <h3>Warum <span style="text-decoration:underline">√ºberhaupt</span> testen?</h3>
                <p class="fragment">Und dann auch noch <strong>vor</strong> dem eigentlichen Code?</p>
                <p class="fragment">Wie viele L√∂cher d√ºrfen es denn sein?</p>
                <div class="fragment">
                    <iframe src="https://giphy.com/embed/81hgp3E9mwHn2" width="480" height="403" frameBorder="0"
                            class="giphy-embed" allowFullScreen></iframe>
                    <p style="font-size:small"><a href="https://giphy.com/gifs/fail-airplane-army-81hgp3E9mwHn2">via
                        GIPHY</a></p>
                </div>
            </section>

            <section>
                <h5>!</h5>
                <ul>
                    <li class="fragment">Kostenlose Dokumentation</li>
                    <li class="fragment">"Wer hat schon Zeit f√ºr Tests wenn das Features doch schon fertig ist?"</li>
                    <li class="fragment">Wir k√∂nnen uns "sicher" f√ºhlen</li>
                    <li class="fragment">Es ist nahezu unm√∂glich schwer wartbaren Code zu schreiben</li>
                    <li class="fragment">Angewandte Psychologie: Die st√§ndige Jagd nach gr√ºn!</li>
                    <li class="fragment">Minimierte Debuggingzeit</li>
                </ul>
                <aside class="notes">
                    <ul>
                        <li>Wie sicher f√ºhlen wir uns, wenn:
                            <ul>
                                <li>wir jederzeit ein Savegame haben?</li>
                                <li>Wir zuversichtlich refactoren k√∂nnen</li>
                            </ul>
                        </li>
                        <li>Wartbarer Code:
                            <br>TDD f√ºhrt zu minimalem leicht testbaren Code
                            <br>leicht testbar === entkoppelt
                            <br>entkoppelt === leicht wartbar
                        </li>
                        <li>Stichwort: Decoupling/Cyclomatic Complexity</li>
                    </ul>
                </aside>
            </section>

            <section>
                <h1>?</h1>
                <h3>Was ist denn die "richtige" Testabdeckung?</h3>
                <p> Also: Wie viel Prozent unseres Codes sollte durch Tests abgedeckt sein?</p>
            </section>

            <section>
                <h3>Aber was sagen <span
                        style="color:#009ee3;background-color:#ffed00;border-bottom:12px solid #a5027d;padding-left:5px;padding-right:5px">Profis</span>
                    zu TDD?</h3>
                <ul>
                    <li class="fragment">Popul√§re Vertreter aus der Industrie: K. Beck, R.C. Martin (Clean *), etc.</li>
                    <li class="fragment">TDD vs Test Last: <br>Qualit√§t: üëç<br>Zeitaufwand: ‚öñÔ∏è <a
                            href="https://sewiki.iai.uni-bonn.de/_media/teaching/labs/xp/2012b/seminar/3-tdd.pdf">[1]</a>
                    </li>
                    <li class="fragment">Gegenmeinungen: <a
                            href="http://compilehorrors.com/test-driven-development-tdd-vs-test-last-development-tld-a-comparative-study/">compilehorrors.com</a>
                    </li>
                    <li class="fragment">Au√üerdem: Fast alle Studien beziehen sich auf Java oder C-Dialekte.</li>
                </ul>
            </section>
        </section>

        <!-- Theorie -->
        <section>
            <section>
                <h4>Die 3 Regeln des TDD¬π</h4>
                <ol>
                    <li><span class="fragment">Schreibe keinen Produktivcode, es sei denn er soll einen fehlgeschlagenen Test bestehen lassen.</span>
                    </li>
                    <li><span class="fragment">Schreibe nicht mehr von einem Unittest, als ausreicht um diesen scheitern zu lassen. Parsingfehler sind Fehler.</span>
                    </li>
                    <li><span class="fragment">Schreibe nicht mehr Produktionscode, als ausreichend ist, um den Test f√ºr eine nicht bestandene Einheit zu bestehen.</span>
                    </li>
                </ol>
                <p style="font-size:16px">¬π Von Uncle Bob frei ins Deutsche und auf PHP angewandt.</p>
            </section>

            <section data-background-image="assets/red-green-refactor.png" data-background-color="#eee"
                     data-background-size="80%"></section>

            <section>
                <h3>Echt jetzt? Ist das nicht ein <span style="text-decoration:underline">RIESEN</span> Overhead?</h3>
            </section>
            <section>
                <h3>Schauen wir uns doch mal ein "recht" verbreitetes Vorgehen an</h3>
                <ul style="list-style: none">
                    <li class="fragment"><span style="color:green">‚è∫</span> Dev implementiert features ‚ûî kein Bug</li>
                    <li class="fragment"><span style="color:green">‚è∫</span> Codereview ‚ûî kein Bug</li>
                    <li class="fragment"><span style="color:green">‚è∫</span> QA ‚ûî kein Bug</li>
                    <li class="fragment"><span style="color:red">‚è∫</span> User ‚ûî Findet Bug!</li>
                    <li class="fragment"><span style="color:green">‚è∫</span> Dev fixt feature ‚ûî kein Bug</li>
                    <li class="fragment"><span style="color:green">‚è∫</span> Codereview ‚ûî kein Bug</li>
                    <li class="fragment"><span style="color:green">‚è∫</span> QA ‚ûî kein Bug</li>
                    <li class="fragment"><span style="color:yellow">‚è∫</span> User ‚ûî Findet keinen Bug (vlt.?!)</li>
                </ul>
            </section>
        </section>

        <!-- KATA -->
        <section>
            <section>
                <h1>TDD Kata: Bowling Game</h1>
            </section>
            <section>
                <h4>Regeln</h4>
                <ul style="list-style:none">
                    <li>10 "Frames" mit 10 Pins</li>
                    <li class="fragment">
                        2 W√ºrfe pro Frame, aber 3 W√ºrfe in Runde 10, wenn 1&2 Wurf Spare oder Strike
                        <ul style="list-style:none">
                            <li class="fragment"><b>Spare:</b> In 2 W√ºrfen abr√§umen</li>
                            <li class="fragment"><b>Strike:</b> In 1 Wurf abr√§umen</li>
                        </ul>
                    </li>
                    <li class="fragment">Framepunkte === umgeworfene Pins (+Bonus)</li>
                    <li class="fragment">
                        Bonuspunkte:
                        <ul style="list-style:none">
                            <li><b>Spare:</b> Im Frame die Punkte des n√§chsten Wurfs</li>
                            <li><b>Strike:</b> Im Frame die Punkte der n√§chsten 2 W√ºrfe</li>
                        </ul>
                    </li>
                </ul>
            </section>

            <!-- Z√§hlsystembild -->
            <section data-background-image="assets/zaehlsystem-1.png" data-background-size="100%"></section>
            <section data-background-image="assets/zaehlsystem-2.png" data-background-size="100%"></section>
            <section data-background-image="assets/zaehlsystem-3.png" data-background-size="100%"></section>
            <section data-background-image="assets/zaehlsystem-4.png" data-background-size="100%"></section>

            <section>
                <h3>Anforderungen</h3>
                <hr>
                <p>Schreibe eine Klasse <b>Game</b> mit zwei Methoden:<br></p>
                <pre><code data-trim data-noescape>
                    # Spielerwurf eintragen
                    public function roll(int $pins);

                    # Punktestand berechnen & ausgeben
                    public function score(): int;
                </code></pre>
            </section>
        </section>

        <section>
            <h1>Lets go! :)</h1>
        </section>

        <section>
            <section>
                <pre>test/GameTest.php</pre>
                <pre><code data-trim data-noescape>
                    class BowlingGameTest extends \PHPUnit\Framework\TestCase
                    {
                        public function testGameExists(): void
                        {
                        }
                    }
                </code></pre>

                <div class="fragment">
                    <pre>‚ùØ./vendor/bin/phpunit test/GameTest.php</pre>
                    <pre>Result:</pre>
                    <pre class="red">>> This test did not perform any assertions</pre>
                </div>
            </section>

            <section>
                <pre>test/GameTest.php</pre>
                <pre><code data-trim data-noescape data-line-numbers="5">
                    class BowlingGameTest extends \PHPUnit\Framework\TestCase
                    {
                        public function testGameExists(): void
                        {
                            $game = new \LokiDev\Bowling\Game();
                        }
                    }
                </code></pre>

                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="red">>> Error : Class 'LokiDev\Bowling\Game' not found</pre>
                </div>
            </section>

            <section>
                <pre>src/Game.php</pre>
                <pre><code data-trim data-noescape>
                    namespace LokiDev;

                    class Game
                    {
                    }
                </code></pre>

                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="red">>> This test did not perform any assertions</pre>
                </div>
            </section>

            <section>
                <pre>test/GameTest.php</pre>
                <pre><code data-trim data-noescape data-line-numbers="5-9">
                    class BowlingGameTest extends \PHPUnit\Framework\TestCase
                    {
                        public function testGameExists(): void
                        {
                            $game = new \LokiDev\Game();
                            self::assertNotEmpty($game);
                            self::assertTrue(method_exists($game, 'score'));
                            self::assertTrue(method_exists($game, 'roll'));
                        }
                    }
                </code></pre>

                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="green">>> OK</pre>
                </div>

                <h1 class="fragment green">!</h1>
            </section>

            <section>
                <h3>Refactor!</h3>
                <pre>test/GameTest.php</pre>
                <pre><code data-trim data-noescape data-line-numbers="3,4,6,10">
                    namespace LokiDev\Bowling\Test;

                    use LokiDev\Bowling\Game;
                    use PHPUnit\Framework\TestCase;

                    class GameTest extends TestCase
                    {
                        public function testCanCreate(): void
                        {
                            $game = new Game();
                            self::assertNotEmpty($game);
                            self::assertTrue(method_exists($game, 'score'));
                            self::assertTrue(method_exists($game, 'roll'));
                        }
                    }
                </code></pre>

                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="green">>> OK</pre>
                </div>
                <h1 class="fragment" style="color:purple">!</h1>
            </section>

            <!-- 02 -->
            <section>
                <h5>First "actual" test</h5>
                <pre><code data-trim data-noescape data-line-numbers="4-7">
                    public function testMinimalOutcome(): void
                    {
                        $game = new Game();
                        for ($i = 0; $i < 20; $i++) {
                            $game->roll(0);
                        }
                        self::assertSame(0, $game->score());
                    }
                </code></pre>

                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="red">>> Error : Call to undefined method LokiDev\Game::roll()</pre>
                </div>
            </section>

            <section>
                <h5>First "actual" test</h5>
                <pre><code data-trim data-noescape data-line-numbers="5-7,9-12">
                    class Game implements BowlingInterface
                    {
                        public function roll(int $pins): void
                        {
                        }

                        public function score(): int
                        {
                            return 0;
                        }
                    }
                </code></pre>

                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="green">>> OK</pre>
                </div>
                <aside class="notes">03-green-rollnscore</aside>
            </section>

            <section>
                <h5>Do not trick ourselves</h5>
                <pre><code data-trim data-noescape>
                    public function testAllOnes(): void
                    {
                        $game = new Game();
                        for ($i = 0; $i < 20; $i++) {
                            $game->roll(1);
                        }
                        self::assertSame(20, $game->score());
                    }
                </code></pre>

                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="red">>> Failed asserting that 0 is identical to 20.</pre>
                </div>
                <aside class="notes">04-red-roll-ones</aside>
            </section>

            <section>
                <h5>Fix: Lets remember pins</h5>
                <pre><code data-trim data-noescape data-line-numbers="3,7,12">
                            class Game
                            {
                                private int $score = 0;

                                public function roll(int $pins): void
                                {
                                    $this->score += $pins;
                                }

                                public function score(): int
                                {
                                    return $this->score;
                                }
                            }
                        </code></pre>

                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="green">>> OK</pre>
                </div>
                <aside class="notes">03-green-rollnscore</aside>
            </section>

            <section>
                <h5>Refactor tests</h5>
                <pre><code data-trim data-noescape data-line-numbers="3,7-10">
                            class GameTest extends TestCase
                            {
                                private Game $game;

                                // ...

                                public function setUp(): void
                                {
                                    $this->game = new Game();
                                }
                            }
                        </code></pre>
            </section>

            <section>
                <h5>Refactor tests</h5>
                <pre><code data-trim data-noescape data-line-numbers="4-9">
                            class GameTest extends TestCase
                            {
                                // ...
                                public function rollPinsMultipleTimes(int $pins, int $times): void
                                {
                                    for ($i = 0; $i < $times; $i++) {
                                        $this->game->roll($pins);
                                    }
                                }
                                // ...
                            }
                        </code></pre>
            </section>

            <section>
                <h5>Refactor tests</h5>
                <pre><code data-trim data-noescape data-line-numbers="4-8">
                    class GameTest extends TestCase
                    {
                        // ...
                        public function testCanCreate(): void
                        {
                            $this->rollPinsMultipleTimes(0, 20);
                            self::assertSame(0, $this->game->score());
                        }

                        public function testAllOnes(): void
                        {
                            $this->rollPinsMultipleTimes(1, 20);
                            self::assertSame(20, $this->game->score());
                        }
                        // ...
                    }
                </code></pre>
            </section>

            <section>
                <h5>Refactor tests</h5>
                <pre><code data-trim data-noescape data-line-numbers="10-14">
                    class GameTest extends TestCase
                    {
                        // ...
                        public function testCanCreate(): void
                        {
                            $this->rollPinsNTimes(0, 20);
                            self::assertSame(0, $this->game->score());
                        }

                        public function testAllOnes(): void
                        {
                            $this->rollPinsNTimes(1, 20);
                            self::assertSame(20, $this->game->score());
                        }
                        // ...
                    }
                </code></pre>
            </section>

            <section>
                <h5>Test</h5>
                <div class="fragment">
                    <pre>Result:</pre>
                    <pre class="green">>> OK</pre>
                </div>
                <aside class="notes">06-purple-refactor-tests</aside>
            </section>

            <section>
                <h1>--> Editor</h1>
            </section>

            <section>
                <h1>Reicht das?</h1>
                <p class="fragment">Nat√ºrlich nicht!</p>
                <p class="fragment">Challenges ;)</p>
            </section>

            <section>
                <h3>Challenges: Game Class</h3>
                <ul>
                    <li class="fragment">Ersetze die h√§sslichen Counter mit einer besseren Struktur (warum haben wir eigentlich 2 davon?)</li>
                    <li class="fragment">Vereinfache isStrike - Warum direkt mehrere Aufrufe in jedem Schritt?</li>
                    <li class="fragment">ifs & fors - H√§ufig ein Hinweis auf refactor Potential: Entferne beides durch foreach (z.B. durch einen FrameGenerator?)</li>
                    <li class="fragment">Objekte. Weniger prozedural mehr echtes OOPS? Verkapselung usw?</li>
                </ul>
            </section>

            <section>
                <h3>Challenges: Test Class</h3>
                <ul>
                    <li class="fragment">Pr√ºfe, dass wir nicht zu h√§ufig rollen! Schmei√üe sonst eine Exception!</li>
                    <li class="fragment">Pr√ºfe, dass wir nur valide Pins rollen (1-10, aber auch 3+8 in einen Frame ausschlie√üen!). Schmei√üe sonst eine Exception</li>
                    <li class="fragment">Meinungsfrage: Sollten wir beim Werfen (roll) oder beim Z√§hlen (score) pr√ºfen?</li>
                </ul>
            </section>

            <section>
                <h1>Fragen?</h1>
                <ul>
                    <li class="fragment">Wie viel Coverage ist "richtig"?</li>
                    <li class="fragment">
                        Reichen 100%?
                        <ul>
                            <li class="fragment">pcov</li>
                            <li class="fragment">Infections</li>
                        </ul>
                    </li>
                    <li class="fragment">Pair programming?</li>
                </ul>
            </section>

        </section>
    </div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/notes/notes.js"></script>
<script src="plugin/markdown/markdown.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script>
    Reveal.initialize({hash: true, plugins: [RevealMarkdown, RevealHighlight, RevealNotes]});
</script>
</body>
</html>
